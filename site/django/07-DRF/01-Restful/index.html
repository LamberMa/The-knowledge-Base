<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>DRF - 雨下不停的知识库</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../..">雨下不停的知识库</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../../..">Welcome to MkDocs</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Django <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">07 DRF</a>
    <ul class="dropdown-menu">
            
<li class="active">
    <a href="./">DRF</a>
</li>
            
<li >
    <a href="../02-DRF认证/">Django Rest FrameWork</a>
</li>
            
<li >
    <a href="../03-DRF权限/">DjangoRestFrameWork权限</a>
</li>
            
<li >
    <a href="../04-DRF访问限制/">DRF访问限制</a>
</li>
            
<li >
    <a href="../05-DRF解析器/">DRF版本&解析器</a>
</li>
            
<li >
    <a href="../06-DRF序列化/">DRF序列化</a>
</li>
            
<li >
    <a href="../07-DRF分页/">分页</a>
</li>
            
<li >
    <a href="../08-DRF视图/">08 DRF视图</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../../..">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../02-DRF认证/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#drf">DRF</a></li>
            <li><a href="#restful">RestFul</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="drf">DRF</h1>
<blockquote>
<p>www.cnblogs.com/wupeiqi/articles/7805382.html</p>
</blockquote>
<h2 id="restful">RestFul</h2>
<h3 id="restful_1">Restful说明</h3>
<ul>
<li>REST与技术无关，代表的是一种软件架构风格，REST是Representational State Transfer的简称，中文翻译为“表征状态转移”</li>
<li>REST从资源的角度类审视整个网络，它将分布在网络中某个节点的资源通过URL进行标识，客户端应用通过URL来获取资源的表征，获得这些表征致使这些应用转变状态</li>
<li>所有的数据，不管是通过网络获取的还是操作（增删改查）的数据，都是资源，将一切数据视为资源是REST区别与其他架构风格的最本质属性</li>
<li>对于REST这种面向资源的架构风格，有人提出一种全新的结构理念，即：面向资源架构（ROA：Resource Oriented Architecture）</li>
</ul>
<h3 id="restful_2">Restful设计规范</h3>
<ul>
<li>API与用户的通信协议，总是使用<a href="http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html">HTTPs协议</a>。（推荐使用https）</li>
<li>域名 </li>
<li>https://api.example.com：尽量将API部署在专用域名（会存在跨域问题，需要自己解决）</li>
<li>
<p>https://example.org/api/：尽量使用这种，这样的API很简单</p>
</li>
<li>
<p>版本：可能存在多个版本共存的情况，版本之间可能也需要过渡，因此url后面一般还会带一个版本</p>
</li>
<li>URL，如：https://api.example.com/v1/    一般版本号放在url</li>
<li>版本好也可以加到请求头                                                  跨域时，引发发送多次请求</li>
<li>路径，视网络上任何东西都是资源（面向资源编程），均使用名词表示（可复数），比如订单order，而不是get_order，或者delete_order这样的url。</li>
<li>https://api.example.com/v1/zoos</li>
<li>https://api.example.com/v1/animals</li>
<li>https://api.example.com/v1/employees</li>
<li>method</li>
<li>GET      ：从服务器取出资源（一项或多项）</li>
<li>POST    ：在服务器新建一个资源</li>
<li>PUT      ：在服务器更新资源（客户端提供改变后的完整资源，即全部更新）</li>
<li>PATCH  ：在服务器更新资源（客户端提供改变的属性，即局部更新）</li>
<li>DELETE ：从服务器删除资源</li>
<li>过滤，通过在url上传参的形式传递搜索条件</li>
<li>https://api.example.com/v1/zoos?limit=10：指定返回记录的数量</li>
<li>https://api.example.com/v1/zoos?offset=10：指定返回记录的开始位置</li>
<li>https://api.example.com/v1/zoos?page=2&amp;per_page=100：指定第几页，以及每页的记录数</li>
<li>https://api.example.com/v1/zoos?sortby=name&amp;order=asc：指定返回结果按照哪个属性排序，以及排序顺序</li>
<li>
<p>https://api.example.com/v1/zoos?animal_type_id=1：指定筛选条件</p>
</li>
<li>
<p>状态码：根据状态码给用户做提示，但是仅仅用状态码是不够的，因此大多使用code+状态码结合使用。status code可以在HTTPResponse中以参数形式返回。现在主要还是以code为主。有的对状态码有需求，有的没有需求，在写接口前要问清楚。</p>
</li>
</ul>
<p>```html
  200 OK - [GET]：服务器成功返回用户请求的数据，该操作是幂等的（Idempotent）。
  201 CREATED - [POST/PUT/PATCH]：用户新建或修改数据成功。
  202 Accepted - [<em>]：表示一个请求已经进入后台排队（异步任务）
  204 NO CONTENT - [DELETE]：用户删除数据成功。
  400 INVALID REQUEST - [POST/PUT/PATCH]：用户发出的请求有错误，服务器没有进行新建或修改数据的操作，该操作是幂等的。
  401 Unauthorized - [</em>]：表示用户没有权限（令牌、用户名、密码错误）。
  403 Forbidden - [<em>] 表示用户得到授权（与401错误相对），但是访问是被禁止的。
  404 NOT FOUND - [</em>]：用户发出的请求针对的是不存在的记录，服务器没有进行操作，该操作是幂等的。
  406 Not Acceptable - [GET]：用户请求的格式不可得（比如用户请求JSON格式，但是只有XML格式）。
  410 Gone -[GET]：用户请求的资源被永久删除，且不会再得到的。
  422 Unprocesable entity - [POST/PUT/PATCH] 当创建一个对象时，发生一个验证错误。
  500 INTERNAL SERVER ERROR - [*]：服务器发生错误，用户将无法判断发出的请求是否成功。</p>
<p>更多看这里：http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html
  ```</p>
<ul>
<li>错误处理，状态码是4xx时，应返回错误信息，推荐用error当做key。</li>
</ul>
<p><code>json
  {
      error: "Invalid API key"
  }</code></p>
<ul>
<li>返回结果，针对不同操作，服务器向用户返回的结果应该符合以下规范。</li>
</ul>
<p><code>GET /collection：返回资源对象的列表（数组）
  GET /collection/resource：返回单个资源对象
  POST /collection：返回新生成的资源对象
  PUT /collection/resource：返回完整的资源对象
  PATCH /collection/resource：返回完整的资源对象
  DELETE /collection/resource：返回一个空文档</code></p>
<ul>
<li>Hypermedia API，RESTful API最好做到Hypermedia，即返回结果中提供链接，连向其他API方法，使得用户不查文档，也知道下一步应该做什么。（其实就是为了让你省事，再给你返回一个url）</li>
</ul>
<p><code>{
      "link": {
          "rel":   "collection https://www.example.com/zoos",
          "href":  "https://api.example.com/zoos",
          "title": "List of zoos",
          "type":  "application/vnd.yourformat+json"
       }
  }</code></p>
<p><strong>谈谈你对Restful规范的认识</strong></p>
<pre><code>本质上就是一个规范，让后台更容易处理，让前端更容易记住这些url，在url上能体现更多的操作。
restful有些适用项目，有些也不适用，不一定要完全符合这个标准，最重要的还是契合项目。
协同开发的时候共同遵循这个规范，让操作更加统一。
推荐使用CBV的方式
</code></pre>

<p>封装体现在两大方面：</p>
<ul>
<li>对方法封装到类中，比如操作文件的增删改查，和操作数据库的增删改查。</li>
<li>将数据封装到对象中，体现在比如学生类，学生的信息都封装在学生类的对象里面。</li>
</ul>
<p>中间件：用户登录认证，rbac，csrftoken</p>
<p>你用过什么中间件？CSRFtoken是怎么实现的？csrf写在了process_view里面，为什么不写在process_request里面呢？虽然都是请求之前做的判断，但是我们知道可以通过添加装饰器免除csrf的验证，也就是验证过程中还要验证这个函数有没有加这个装饰器。因为在process_request执行完了以后才执行的路由的匹配，才找到的那个函数。process_view方法用来检查视图是否被装饰器装饰，装饰了就可免除认证。去请求体或者cookie中获取token，然后根据获取的token做校验。</p>
<p>开发模式</p>
<ol>
<li>普通模式：前后端放到一起写</li>
<li>前后端分离的模式</li>
</ol></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
